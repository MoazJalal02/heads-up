"use client"

import { useTransition } from 'react'
import styles from './trashIcon.module.css'
import { objectId } from '@/lib/types'

type TrashIconProps = {
    id: objectId
    deleteCartItem: (id:objectId) => Promise<void>
}

export default function TrashIcon({ id, deleteCartItem }: TrashIconProps) {
    const [ isPending, startTransition ] = useTransition()

    return (
        <>
            {!isPending?
                <svg 
                    onClick={ () => startTransition( async () => await deleteCartItem(id))}  
                    className={styles.trashIcon} 
                    width="16" 
                    height="21" 
                    viewBox="0 0 16 21" 
                    fill="none" 
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.6805 9.60697C5.67624 9.50325 5.6908 9.39965 5.72331 9.30242C5.75581 9.20519 5.80557 9.11635 5.86959 9.04127C5.93361 8.96619 6.01056 8.90643 6.09578 8.8656C6.18101 8.82478 6.27274 8.80372 6.36543 8.80372C6.45812 8.80372 6.54985 8.82478 6.63507 8.8656C6.7203 8.90643 6.79724 8.96619 6.86126 9.04127C6.92528 9.11635 6.97505 9.20519 7.00755 9.30242C7.04005 9.39965 7.05461 9.50325 7.05036 9.60697V15.2906C7.05461 15.3944 7.04005 15.498 7.00755 15.5952C6.97505 15.6924 6.92528 15.7813 6.86126 15.8563C6.79724 15.9314 6.7203 15.9912 6.63507 16.032C6.54985 16.0728 6.45812 16.0939 6.36543 16.0939C6.27274 16.0939 6.18101 16.0728 6.09578 16.032C6.01056 15.9912 5.93361 15.9314 5.86959 15.8563C5.80557 15.7813 5.75581 15.6924 5.72331 15.5952C5.6908 15.498 5.67624 15.3944 5.6805 15.2906V9.60697ZM14.8804 6.38924L14.1759 16.7942C14.1237 17.6536 13.799 18.4639 13.2603 19.0787C12.998 19.3765 12.6854 19.6127 12.3406 19.7735C11.9959 19.9343 11.626 20.0165 11.2525 20.0152H4.74315C4.37018 20.0161 4.00077 19.9338 3.65653 19.773C3.31229 19.6122 3.00012 19.3762 2.73827 19.0787C2.19925 18.464 1.87402 17.6538 1.82117 16.7942L1.11961 6.38924H0V4.15659C0 3.61869 0.235783 3.41454 0.700118 3.41454H3.98951V1.85428C3.99066 1.39102 4.15547 0.947106 4.44793 0.619533C4.74038 0.291959 5.13671 0.107362 5.55031 0.106079L10.4497 0.106079C10.8625 0.108642 11.2578 0.293803 11.5493 0.621239C11.8408 0.948675 12.005 1.39186 12.0061 1.85428V3.41292H15.3838C15.4322 3.41178 15.4805 3.41503 15.5284 3.42264C15.6527 3.4449 15.7665 3.51349 15.8516 3.6173C15.9367 3.7211 15.9879 3.85404 15.9971 3.99457C15.9971 4.02698 15.9971 4.05614 15.9971 4.08693V6.38924H14.8804ZM13.5062 6.41678H2.49381L3.18235 16.6808C3.20992 17.173 3.39297 17.6382 3.69876 17.9932C3.83426 18.148 3.99614 18.2708 4.17479 18.3543C4.35344 18.4378 4.54524 18.4803 4.73881 18.4792H11.2482C11.4417 18.4797 11.6333 18.437 11.8119 18.3535C11.9905 18.2701 12.1524 18.1476 12.2882 17.9932C12.5953 17.6389 12.7794 17.1735 12.8075 16.6808L13.5062 6.42488V6.41678ZM10.2703 3.41292V2.05843H5.73402V3.41292H10.2703ZM8.94964 9.60697C8.94539 9.50325 8.95995 9.39965 8.99245 9.30242C9.02495 9.20519 9.07472 9.11635 9.13874 9.04127C9.20276 8.96619 9.2797 8.90643 9.36493 8.8656C9.45015 8.82478 9.54188 8.80372 9.63457 8.80372C9.72726 8.80372 9.81899 8.82478 9.90422 8.8656C9.98944 8.90643 10.0664 8.96619 10.1304 9.04127C10.1944 9.11635 10.2442 9.20519 10.2767 9.30242C10.3092 9.39965 10.3238 9.50325 10.3195 9.60697V15.2906C10.3238 15.3944 10.3092 15.498 10.2767 15.5952C10.2442 15.6924 10.1944 15.7813 10.1304 15.8563C10.0664 15.9314 9.98944 15.9912 9.90422 16.032C9.81899 16.0728 9.72726 16.0939 9.63457 16.0939C9.54188 16.0939 9.45015 16.0728 9.36493 16.032C9.2797 15.9912 9.20276 15.9314 9.13874 15.8563C9.07472 15.7813 9.02495 15.6924 8.99245 15.5952C8.95995 15.498 8.94539 15.3944 8.94964 15.2906V9.60697Z" fill="#767676"/>
                </svg>
                :<div className={styles.loader}><div className={styles.spinner}></div></div>  
        }
        </>

    )
}
